------2024-11-27 10:32:44.591--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (172142287819284,172014907953138,172500828896506,172607403162369,172536310553096,172833865945774,172826849407525,172883846747677,172845070263743,172915316461579,172916515301551,173073830219635,173003917791539,172942199938757,173218101826764,172994599940085,173048283479078,173180611059365,173039801116790,171600769884394,172094640776293,172323368089805,172538656165089,172832925147280,172702647507138) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 10:44:46.777--------
explain insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (173024146040385,173081065032930,172942397112523,172995204954999,172873731068266,173048423376632,173206572162936,172462117013770,172507805197770,172537873855745,172672800917498,172908639931085,173159142516216,172883272279560,172984465918995,173203885696766,173012183744611,173034962533477,172812790329299,172946627850182,173161832438232,173109235475898,173080614676304,172872484133815,172972648904368) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 10:45:26.495--------
explain insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (173024146040385,173081065032930,172942397112523,172995204954999,172873731068266,173048423376632,173206572162936,172462117013770,172507805197770,172537873855745,172672800917498,172908639931085,173159142516216,172883272279560,172984465918995,173203885696766,173012183744611,173034962533477,172812790329299,172946627850182,173161832438232,173109235475898,173080614676304,172872484133815,172972648904368) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 10:46:48.525--------
explain insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (173024146040385,173081065032930,172942397112523,172995204954999,172873731068266,173048423376632,173206572162936,172462117013770,172507805197770,172537873855745,172672800917498,172908639931085,173159142516216,172883272279560,172984465918995,173203885696766,173012183744611,173034962533477,172812790329299,172946627850182,173161832438232,173109235475898,173080614676304,172872484133815,172972648904368) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 10:47:10.412--------
explain insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (173024146040385,173081065032930,172942397112523,172995204954999,172873731068266,173048423376632,173206572162936,172462117013770,172507805197770,172537873855745,172672800917498,172908639931085,173159142516216,172883272279560,172984465918995,173203885696766,173012183744611,173034962533477,172812790329299,172946627850182,173161832438232,173109235475898,173080614676304,172872484133815,172972648904368) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 10:47:48.703--------
explain insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (173024146040385,173081065032930,172942397112523,172995204954999,172873731068266,173048423376632,173206572162936,172462117013770,172507805197770,172537873855745,172672800917498,172908639931085,173159142516216,172883272279560,172984465918995,173203885696766,173012183744611,173034962533477,172812790329299,172946627850182,173161832438232,173109235475898,173080614676304,172872484133815,172972648904368) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 10:47:57.733--------
explain insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (172926426553560,172962617618985,173136306222229,173133173702794,172651421465872,172628208281253,172782217749166,172855434720121,172886721061767,172964270943418,173060342259922,173082989441710,173218413736752,172996066629383,173194838694858,173187157689636,173015910670744,173017360880915,173096080402237,172999897338846,173186434454785,173186364587722,173030972302176,172979606040209,172635400005507) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 10:53:42.365--------
explain insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (173024146040385,173081065032930,172942397112523,172995204954999,172873731068266,173048423376632,173206572162936,172462117013770,172507805197770,172537873855745,172672800917498,172908639931085,173159142516216,172883272279560,172984465918995,173203885696766,173012183744611,173034962533477,172812790329299,172946627850182,173161832438232,173109235475898,173080614676304,172872484133815,172972648904368) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 10:54:44.777--------
explain insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (173024146040385,173081065032930,172942397112523,172995204954999,172873731068266,173048423376632,173206572162936,172462117013770,172507805197770,172537873855745,172672800917498,172908639931085,173159142516216,172883272279560,172984465918995,173203885696766,173012183744611,173034962533477,172812790329299,172946627850182,173161832438232,173109235475898,173080614676304,172872484133815,172972648904368) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 10:54:54.530--------
explain insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (172926426553560,172962617618985,173136306222229,173133173702794,172651421465872,172628208281253,172782217749166,172855434720121,172886721061767,172964270943418,173060342259922,173082989441710,173218413736752,172996066629383,173194838694858,173187157689636,173015910670744,173017360880915,173096080402237,172999897338846,173186434454785,173186364587722,173030972302176,172979606040209,172635400005507) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 10:55:26.283--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (173024146040385,173081065032930,172942397112523,172995204954999,172873731068266,173048423376632,173206572162936,172462117013770,172507805197770,172537873855745,172672800917498,172908639931085,173159142516216,172883272279560,172984465918995,173203885696766,173012183744611,173034962533477,172812790329299,172946627850182,173161832438232,173109235475898,173080614676304,172872484133815,172972648904368) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 10:55:55.642--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (172926426553560,172962617618985,173136306222229,173133173702794,172651421465872,172628208281253,172782217749166,172855434720121,172886721061767,172964270943418,173060342259922,173082989441710,173218413736752,172996066629383,173194838694858,173187157689636,173015910670744,173017360880915,173096080402237,172999897338846,173186434454785,173186364587722,173030972302176,172979606040209,172635400005507) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 10:56:22.991--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (172711236808803,172746066538687,172808953844874,172738007506507,172844606762339,172892906551226,172894123653267,173108068187675,173147596883839,173008014352125,173212790994395,173211738461825,172880646138690,173058616745914,173141159802828,173153302347888,172388706260361,172610906813201,172712225730808,172706299014034,172824120896106,172813414031137,172738357041036,172753017789027,172893706360453) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 10:56:51.036--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (173166333222706,173187256387481,173077685776360,172836490503328,172927974096541,172094585966837,172247543539844,172255368477460,172643984556211,172751351130623,172687060068591,172846394944260,172843714878455,173004833962806,172966258609436,172932961873100,172933395708932,173090467253422,173106152604694,173076526487895,172917158461793,173032194567219,172972101606180,173144425055786,173155305430072) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 10:57:17.329--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (173156171209168,171353124702155,171977155914719,172061357988981,172492193939047,172591565440646,172711251758148,172841937168652,173160723286096,172882443827437,173011248843467,172810817472973,173173961861176,173178854386148,173205888192741,173077471353004,173016518329222,173029317395027,173101886636999,173168554719978,173152288578781,171270749897472,172021282357445,172372801788810,172518252812645) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 10:57:45.492--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (172600477596843,172729460659257,172633218471872,172717780805051,172821433825843,172702532683965,172829774922022,172922119426395,172994112126102,172875019813261,172901916865767,173079442964918,172873973148617,172937318202144,172195002039775,172312576528592,172562680147563,172648246223456,172674772185292,172736746436355,172845667788596,172789579727886,172840476139215,172906950966223,172890631887374) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 10:58:11.184--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (172997140421512,172902193822257,172932703547954,172923868945284,173067692040849,173033050531582,173057542307570,173136560637963,173134785571009,171640279279009,171819065626978,172399894690399,172242689152890,172261740190552,172479428687417,172493702414419,172586618263141,172710272055345,172823992343173,172790622864264,172721454854381,173003309900505,173074819862552,172942313811837,172996385854603) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 10:58:37.182--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (173165746395266,173177968929746,173029595078132,173039799405343,173006530545619,171615072741575,172382671303099,172429756259184,172456008883179,172579639025270,172602636754807,172819200904814,172761734565860,172827178122732,173106685559204,172857274356538,172958274662728,173126227435880,173067505964116,173081918610170,172881760281958,173079389622615,172942619888154,172941223127627,173178657651039) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 10:59:03.186--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (173092737657931,173077309011020,173210151519451,173201209080896,172293683741564,172512185008879,172641537533759,172725823350707,172625130149523,172789130354809,172840463449909,172959358533077,173121305565664,173001901694854,173115274527753,172926341049522,173222577571193,173094476333276,173193267429341,172617999114603,172605566421839,172770132108048,172797069842411,172717479744709,172828798613354) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 10:59:29.485--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (172906699234735,173070119853756,172969747785242,173179162936120,172956643418583,173215372168888,173048064624608,173169758652771,173136111808599,171925369246643,172212610113512,172546201050564,172529963718203,172643826503018,172807015401148,172633973144222,172794646799009,172804575989442,172879318196336,173066569284004,173075082354077,173120137159198,173162906547797,173218507922478,173092867268255) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 10:59:56.103--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (173031502511592,172997566389012,172960953246723,173083631036125,173094481216003,173134948686378,171914024326529,172092497738167,171957155223066,172377407430792,172467341852357,172816727963171,172780448343860,172847785327218,172841023530244,172834601537978,172884238029004,173057584327158,172896811783599,172899281955378,173196593579516,173029074237255,172876320738291,173164779034290,172995073529400) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 11:00:22.829--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (173092010059234,173118826979226,172997223807695,171797531190508,172263487945920,172504846799546,172606663682745,172699210490364,172780145437532,172828876824677,172925958338150,172959605349895,172912562822810,172890348498571,172891021411888,173004893649033,173066802108231,173203153054016,173093630618483,173021889048045,173162067493050,173194428310965,173222410116191,172971092635645,173168964529159) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 11:00:48.847--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (173225119682221,171650215405730,172071639242693,172355414481150,172694778153866,172736364598170,172911498394664,172690754441961,172968454706323,172875859067872,173014548647203,173137145295135,173210176207595,172978464979398,172961134345373,170331352621699,172729298104089,172813797008469,172830342012205,172829203518509,172917917130658,173064561697881,173009408151981,173183706923012,173047121305543) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 11:01:15.701--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (173030508709041,173038394730647,173038007378881,173123252171093,171959583436367,172295177279501,172478239528856,172496420511532,172585029283568,172530312822161,172652235466772,172764053135043,172763406738988,172797967103522,172820334876518,173063112509364,172895104691755,172897969852854,172904640584346,173014523786087,172937361208709,173140458689540,172942227156623,173093382744056,173185562871641) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 11:01:42.638--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (173029821018606,173084150023318,173135682115559,173099431788742,173167990016265,172502557119509,172667936362069,172632474681132,172626175031625,172707498803212,172815230320352,172831662121584,172806304548671,172853873103277,172980654618550,173073686786513,172975838918049,172895299550219,173190780242961,173075564765368,173028045345329,173082706680732,173114130603179,173218661465776,173125792876781) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 11:02:10.182--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (173210226976403,172971941534027,172978519377235,173145521476505,172312895682852,172341616153624,172296548517606,172425863293511,172464441612192,172613629569074,172622202157973,172718847418988,172823210091700,172839545380655,172912932478579,173076303117920,173081232513231,173098282434782,173091989398693,173212883395203,172936787750661,173200598424958,173020060455972,173098745342031,173134501594497) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 11:02:38.090--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (171984225283054,172526606707363,172537152595050,172768845517014,172830638579968,172847485831247,172837163705523,173062954523087,173080697817330,173047460702819,173006316357372,173095927867943,169203678874179,172304954776303,172420020028121,172567819389561,172652256495795,172815621761117,172786227277242,172686256380486,172742477209496,172831455718176,173160132516750,172886644069958,172917978658211) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 11:03:06.898--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (172918209895874,172925595763912,173067488227693,172995687514710,173177653007261,173153236138091,172978934997182,173094000848124,173095473142613,172274743461206,172367010826198,172380358583892,172312928402996,172596211464690,172728134618628,172767436787086,172695696152520,172705372350377,172831772855379,172792097673977,172840276455717,173004282679045,172985593939541,173082890859860,173035084519452) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 11:03:38.791--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (173033522718193,172938250993520,173095023689754,172470984507500,172590247049934,172620770096300,172630778318162,172792650761249,172883837260473,173003993033737,173132325961160,172968142754194,173028381519019,172891485354777,172926065069313,173022277951261,173077145289243,173033122943533,173086863383144,172978178329338,173135619402600,172586628919460,172660436555223,172650051884978,172718999556548) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 11:04:06.215--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (172777374340317,172821050781757,172878623385622,173023790566163,173189623939492,173055870353529,173127137824964,173177976260619,173186613758467,173041881839460,171172815432305,171479485100975,171930255105264,172597003870717,172700316265775,172827316427701,172885967006766,172883505876141,172910865406888,173157921639289,173065278718960,173055400997669,173179966678111,173178012517344,173151810700899) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 11:04:32.587--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (173193119753057,172104430867822,172191439230046,172590745731930,172636898542830,172761277694511,172711035630133,172853726190751,172943738581333,172890776402956,172888719212942,173023351719256,173149111084900,172954072731671,173091144374867,173136894992108,172932779710248,172982565838351,172939229708872,172521983067405,172561458756453,172641614243220,172530736859806,172818310160773,172735080699449) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 11:04:58.702--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (172776478891590,172754065298617,172844860197622,172837107942235,172837663151876,172893205466374,172892154465711,173073696618440,172987481787796,173011781686537,173034493038411,173179731073976,173093567809113,173032118117234,173051890032869,172980042055469,170698711892021,172126564658303,172158600140256,172195403482982,172433839563679,172612744105693,172601392020515,172623090498969,172624427832787) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 11:05:25.436--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (172673448608609,172782116273216,172837522574740,172917960312825,173082442606376,173070627434038,173091539528250,173026837898784,173141399167103,173162525539953,173191049270598,173080428289827,173151321132807,172119916980754,172054497845378,172117226023686,172255878456972,172472556232717,172477649565797,172502543991276,172594280407470,172534980343035,172728668658258,172620229728840,172677610020492) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 11:05:52.877--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (172763804244987,172764315711838,172741554673215,172777203563216,172882552570781,173220078727297,173220684081432,173202410014114,172925252321567,173030775029807,173211703816395,173105944866796,172952287542250,173017264185492,173015755480655,173048228931407,173032323039151,172997528290739,173133471046483,172119670907202,171905475392829,172306382385485,172561035070315,172657736195872,172628630296283) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 11:06:19.457--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (172892787508273,173172430733227,173090612312423,172948167838344,172996796357492,173104177349335,173166385275700,173022102632304,173125669524257,173029199358267,172978172809071,173224767239487,173150893345857,173150663532726,171017151560227,171992912036146,171999928486874,172383740485383,172373406390584,172522171855718,172624838201598,172678544104342,172679702465750,172806589904867,172853696133574) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 11:06:45.709--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (172837877054102,173108021086242,173073862823447,173004673130605,173004143133423,173065954389485,173075710835568,172996545648519,173093237596617,173170848393685,172938202912784,171804440628034,172423194984715,172547988388139,172786617949779,172718445554839,172761206734725,172879685656383,173074728877965,173056527863122,173049283292144,173070357452446,173025700876189,173124337528867,172916382974025) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 11:07:11.454--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (173097632428837,173048263372286,173041937575661,172983366475426,173123864359567,172120005487479,172051758234453,172387247406923,172495482296329,172672162518082,172614708817853,172751219993273,172778832220488,172849624311918,172838791137985,173160492995240,173203036187708,173074638385668,172875568833966,172876085565230,173082237418738,173091818907402,173173904001807,173179563614012,173092388537704) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 11:07:37.647--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (173016382450647,173171016036777,173152358119676,173133433360688,172294508950792,172519541277821,172545620628833,172734112572206,172684993823910,172705264707101,172710497635843,172838632955228,172837822283281,173108660814763,173203390363850,172954057064299,172874100214789,173211474292680,173212007974384,173013680837703,173183215148228,173080482748193,173080502169638,173115879184018,172875884763828) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 11:08:03.810--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (173181372159422,173039681079249,172399425225004,172376347400580,172765952687224,172657862808372,172776920593160,172856837807670,172866483405947,172889963042641,173074049573744,172864684632222,172901527706724,172930541775534,172881690793492,173169941719753,173185982217286,173186739187115,171479497924645,171433545098319,171537572267940,172503938890470,172556069292158,172674630788905,172676379863297) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
------2024-11-27 11:08:29.872--------
insert into visitor_tickets (id, created_date, transaction_id, invoice_id, channel_id, channel_name, reseller_id, reseller_name, saledesk_id, saledesk_name, financial_id, financial_name, transaction_type_name, transaction_type_id, ticketId, shared_capacity_id, ticket_booking_id, related_order_id, related_booking_id, ticket_title, ticketwithdifferentpricing, ticketpriceschedule_id, ticket_extra_option_id, group_type_ticket, group_price, group_quantity, group_linked_with, selected_date, booking_selected_date, from_time, to_time, slot_type, amount_before_extra_discount, discount_before_extra_discount, hto_id, visitor_group_no, roomNo, nights, user_age, gender, user_image, visitor_country, merchantAccountCode, merchantReference, original_pspReference, shopperReference, partner_id, relational_partner_id, partner_name, museum_name, museum_id, hotel_name, hotel_id, pos_point_id, pos_point_name, shift_id, passNo, pass_type, ticketAmt, visit_date, visit_date_time, ticketType, tickettype_name, discount_applied_on_how_many_tickets, paid, payment_method, isBillToHotel, card_name, pspReference, card_type, captured, age_group, discount, isDiscountInPercent, updated_discount_type, without_elo_reference_no, debitor, creditor, split_cash_amount, split_card_amount, split_voucher_amount, split_direct_payment_amount, total_gross_commission, total_net_commission, commission_type, partner_gross_price, order_currency_partner_gross_price, partner_gross_price_without_combi_discount, partner_net_price, order_currency_partner_net_price, partner_net_price_without_combi_discount, isCommissionInPercent, tax_id, tax_value, tax_name, timezone, invoice_status, row_type, updated_by_id, updated_by_username, voucher_updated_by, voucher_updated_by_name, redeem_method, redeem_by_ticket_id, redeem_by_ticket_title, cashier_id, cashier_name, cashier_register_id, targetlocation, paymentMethodType, targetcity, service_name, adjustment_row_type, description, distributor_status, adyen_status, adjustment_method, all_ticket_ids, time_based_done, visitor_invoice_id, ticketPrice, deleted, is_refunded, is_block, is_edited, vt_group_no, user_name, issuer_country_code, distributor_commission_invoice, activation_method, is_prioticket, is_shop_product, shop_category_name, external_account_number, used, ticket_status, is_prepaid, is_purchased_with_postpaid, invoice_type, supplier_currency_symbol, order_currency_code, order_currency_symbol, currency_rate, invoice_variant, service_cost, service_cost_net_amount, service_cost_type, scanned_pass, groupTransactionId, booking_status, channel_type, is_voucher, extra_text_field_answer, distributor_type, distributor_partner_id, distributor_partner_name, issuer_country_name, chart_number, extra_discount, manual_payment_note, account_number, is_custom_setting, external_product_id, supplier_currency_code, col1, col2, partner_category_id, col4, partner_category_name, col6, col7, col8, is_data_moved, action_performed, updated_at, tp_payment_method, order_confirm_date, payment_date, order_cancellation_date, voucher_creation_date, primary_host_name,supplier_gross_price, supplier_discount, supplier_ticket_amt, supplier_tax_value,supplier_net_price, last_modified_at, market_merchant_id, merchant_admin_id, order_updated_cashier_id, order_updated_cashier_name, version, supplier_tax_id, merchant_currency_code, merchant_price, merchant_net_price, merchant_tax_id, admin_currency_code) select vt.id, vt.created_date, vt.transaction_id, vt.invoice_id, vt.channel_id, vt.channel_name, vt.reseller_id, vt.reseller_name, vt.saledesk_id, vt.saledesk_name, vt.financial_id, vt.financial_name, vt.transaction_type_name, vt.transaction_type_id, vt.ticketId, vt.shared_capacity_id, vt.ticket_booking_id, vt.related_order_id, vt.related_booking_id, vt.ticket_title, vt.ticketwithdifferentpricing, vt.ticketpriceschedule_id, vt.ticket_extra_option_id, vt.group_type_ticket, vt.group_price, vt.group_quantity, vt.group_linked_with, vt.selected_date, vt.booking_selected_date, vt.from_time, vt.to_time, vt.slot_type, vt.amount_before_extra_discount, vt.discount_before_extra_discount, vt.hto_id, vt.visitor_group_no, vt.roomNo, vt.nights, vt.user_age, vt.gender, vt.user_image, vt.visitor_country, vt.merchantAccountCode, vt.merchantReference, vt.original_pspReference, vt.shopperReference, vt.partner_id, vt.relational_partner_id, vt.partner_name, vt.museum_name, vt.museum_id, vt.hotel_name, vt.hotel_id, vt.pos_point_id, vt.pos_point_name, vt.shift_id, vt.passNo, vt.pass_type, vt.ticketAmt, vt.visit_date, vt.visit_date_time, vt.ticketType, vt.tickettype_name, vt.discount_applied_on_how_many_tickets, vt.paid, vt.payment_method, vt.isBillToHotel, vt.card_name, vt.pspReference, vt.card_type, vt.captured, vt.age_group, vt.discount, vt.isDiscountInPercent, vt.updated_discount_type, vt.without_elo_reference_no, vt.debitor, vt.creditor, vt.split_cash_amount, vt.split_card_amount, vt.split_voucher_amount, vt.split_direct_payment_amount, vt.total_gross_commission, vt.total_net_commission, vt.commission_type,'0.00' as partner_gross_price, vt.order_currency_partner_gross_price, vt.partner_gross_price_without_combi_discount,'0.00' partner_net_price, vt.order_currency_partner_net_price, vt.partner_net_price_without_combi_discount, vt.isCommissionInPercent, vt.tax_id, vt.tax_value, vt.tax_name, vt.timezone, vt.invoice_status, vt.row_type, vt.updated_by_id, vt.updated_by_username, vt.voucher_updated_by, vt.voucher_updated_by_name, vt.redeem_method, vt.redeem_by_ticket_id, vt.redeem_by_ticket_title, vt.cashier_id, vt.cashier_name, vt.cashier_register_id, vt.targetlocation, vt.paymentMethodType, vt.targetcity, vt.service_name, vt.adjustment_row_type, vt.description, vt.distributor_status, vt.adyen_status, vt.adjustment_method, vt.all_ticket_ids, vt.time_based_done, vt.visitor_invoice_id, vt.ticketPrice, vt.deleted, vt.is_refunded, vt.is_block, vt.is_edited, vt.vt_group_no, vt.user_name, vt.issuer_country_code, vt.distributor_commission_invoice, vt.activation_method, vt.is_prioticket, vt.is_shop_product, vt.shop_category_name, vt.external_account_number, vt.used, vt.ticket_status, vt.is_prepaid, vt.is_purchased_with_postpaid, vt.invoice_type, vt.supplier_currency_symbol, vt.order_currency_code, vt.order_currency_symbol, vt.currency_rate, vt.invoice_variant, vt.service_cost, vt.service_cost_net_amount, vt.service_cost_type, vt.scanned_pass, vt.groupTransactionId, vt.booking_status, vt.channel_type, vt.is_voucher, vt.extra_text_field_answer, vt.distributor_type, vt.distributor_partner_id, vt.distributor_partner_name, vt.issuer_country_name, vt.chart_number, vt.extra_discount, vt.manual_payment_note, vt.account_number, vt.is_custom_setting, vt.external_product_id, vt.supplier_currency_code, vt.col1, vt.col2, vt.partner_category_id, vt.col4, vt.partner_category_name, vt.col6, vt.col7, vt.col8, vt.is_data_moved, concat(vt.action_performed, ' EECOMBICommission'), vt.updated_at, vt.tp_payment_method, vt.order_confirm_date, vt.payment_date, vt.order_cancellation_date, vt.voucher_creation_date, vt.primary_host_name,vt.supplier_gross_price, vt.supplier_discount, vt.supplier_ticket_amt, vt.supplier_tax_value,vt.supplier_net_price, vt.last_modified_at, vt.market_merchant_id, vt.merchant_admin_id, vt.order_updated_cashier_id, vt.order_updated_cashier_name, ROUND((vt.version+1),2) as version, vt.supplier_tax_id, vt.merchant_currency_code, vt.merchant_price, vt.merchant_net_price, vt.merchant_tax_id, vt.admin_currency_code from visitor_tickets vt join (SELECT transaction_id, vt_group_no, ticketId, ticketpriceschedule_id, max(version) as version FROM visitor_tickets where vt_group_no in (172778320106807,172858372819246,172849190955921,172850609336199,172871901767260,173063467560382,173135398724398,173066827387142,173202410952383,172933522744248,172964143776557,173141120720439,173117891395093,173221542039655,173053390909383,173006192602219,173151874239295,171941020732035,172200005322708,172334075964491,172639936220490,172653446885913,172751692427768,172840786905226,172839451903195) and col2 = 2 group by transaction_id, vt_group_no, ticketId, ticketpriceschedule_id) as mv on vt.vt_group_no = mv.vt_group_no and (vt.transaction_id+1) = (mv.transaction_id+1) and ABS(vt.version - mv.version) = '0' and vt.ticketId = mv.ticketId and vt.ticketpriceschedule_id = mv.ticketpriceschedule_id;SELECT ROW_COUNT();
