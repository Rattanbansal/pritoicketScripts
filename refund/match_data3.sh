#!/bin/bash

# Define your order IDs here as a space-separated list
order_ids="173117618129591 173117618989155 173117619751685 173117705318192 173117722595751 173117893150431 173118202557224 173118212400624 173118277094650 173118322363881 173118360069922 173118386844266 173118396937888 173118416662654 173118656370573 173118664652381 173118758541216 173118941034828 173119009515394 173119200546085 173119256257425 173119323840896 173119909426331 173122350665001 173123030314156 173123119714352 173123251306146 173123291266142 173123598557647 173123699149033 173123879807767 173124054271424 173124226640384 173124389924371 173124390621790 173124441451483 173124489478172 173124536652202 173124668213985 173124720815250 173124855248460 173124874520620 173124876723237 173125095394992 173125192123140 173125275197788 173125286550427 173125378252861 173125498477916 173125675095741 173126156155776 173126312318516 173126413499823 173126476263748 173126523112069 173126588086976 173126850665793 173126919437972 173126978048403 173127064551657 173127162175283 173127223398125 173127234212270 173127240288078 173127247848950 173127368831468 173127381129120 173127382469696 173127418615889 173127459796567 173127476485035 173127528990757 173127536344910 173127613771207 173127799907710 173127844298564 173128099711668 173130551108126 173130564170904 173131184871723 173131212643908 173131451538800 173131591195432 173131734419387 173131828991944 173131941543630 173131993613952 173132287057899 173132570531948 173132586433401 173132627619953 173132699515685 173132703897876 173132705460778 173132860593583 173132937588226 173133006029223 173133089848325 173133161444670 173133177549844 173133353948423 173133404917224 173133624234984 173133680615946 173134142944150 173134194994873 173134218282210 173134483445463 173134996291940 173135082279739 173135084525455 173135110517957 173135117789865 173135286211086 173135482805027 173135524850004 173135571170256 173135591860344 173135607006802 173135656060625 173135715831216 173135792583217 173135854605983 173135885583189 173135981594693 173136069306063 173136124875231 173136170741886 173136200826565 173136330990959 173136549369135 173139861554236 173140164272101 173140365210035 173140466008796 173140583413397 173140640734450 173140728299123 173140944364644 173141294447495 173141336268818 173141339096784 173141346569899 173141434027073 173141526460769 173142410266491 173142488085355 173142532405065 173142741406760 173142810231088 173143131614228 173143275894860 173143520830748 173143560016702 173143842470399 173143918931807 173144003339689 173144092043508 173144164894308 173144207771997 173144245432096 173144402598547 173144421814122 173144542267481 173144576574819 173144848712672 173144909746050 173148112693621 173148284839184 173148763290663 173148771421605 173148999397526 173149017329167 173149096438159 173149104095545 173149220790351 173149227985444 173149509747841 173149577924525 173149621570017 173149798622448 173149987264347 173150000924580 173150017937186 173150251588855 173150433980469 173150754670701 173151727320739 173151794108361 173151824440661 173151825489864 173152078304743 173152164745916 173152337308072 173152533400808 173152545163639 173152910937333 173152915413165 173152953140726 173153035102973 173153046531164 173153179097348 173153207753777 173153208834837 173153293543306 173153335956818 173153339132823 173153457083687 173153458300595 173153472321582 173153473739686 173153490502009 173153586864366 173153617450509 173153670713295 173153930055252 173154274813951 173157500486700 173157901658567 173157909883409 173157910886534 173158167698914 173158181587175 173158431316855 173158439650772 173158496607091 173158587673822 173158608133195 173158773278630 173158848124447 173158921520850 173158921978139 173158932369811 173159021713244 173159068122952 173159133441273 173159280936142 173159450984423 173159536991265 173159572263725 173159577218240 173159677878284 173159697948617 173159797468239 173160082390391 173160104759194 173160174420017 173160393374998 173160577152939 173160718908474 173160806121716 173161010252710 173161013513090 173161064482651 173161098903253 173161169670368 173161225072403 173161268057084 173161276112810 173161365869009 173161386134507 173161431892700 173161566154903 173161628077262 173161677632678 173161714047186 173161741870344 173161936568279 173162098002366 173162104718634 173162369622979 173162382228640 173162394784329 173162484285305 173162494467914 173165447749952 173165693384545 173165865913928 173166011940203 173166249955754 173166256545533 173166368233129 173166672013728 173166833160001 173166931228258 173167089375183 173167371324191 173167848098329 173168072290521 173168085430585 173168616657288 173168769316331 173168838025946 173168888986510 173168942138516 173169065272513 173169195562328 173169643448509 173169748836349 173169787861124 173170365765137 173170421102347 173170465882917 173170475471600 173170610898913 173170627271383 173170932419752 173171105391832 173171139761336 173171143872848 173171146505797 173171292817317 173174478109809 173174732843245 173174794935081 173174912410034 173175007264699 173175053058150 173175193519673 173175210393778 173175388723792 173175552703889 173175616029125 173175626041315 173175894980613 173176007347789 173176037347920 173176048330892 173176246083367 173176542786854 173176730316863 173176901182183 173177028497644 173177152855831 173177268482028 173177350499698 173177357254682 173177374849269 173177429476811 173177466980424 173177611426771 173177665442052 173177678929739 173177841369880 173177842640523 173178130651898 173178305452164 173178312358931 173178518563413 173178627155397 173178652521066 173178938978217 173179007247435 173179128520835 173179137604999 173179193286576 173179310864901 173179375708598 173179461862537 173183125074140 173183186323743 173183494750289 173183516573170 173183729475870 173183788866269 173183899023310 173184056882374 173184080673786 173184236193485 173184244143844 173184352252819 173184424882865 173184623304677 173184648918037 173184800868611 173184804533181 173184812215089 173184878154747 173185381686540 173185575876865 173185612118471 173185700587387 173185701870315 173185829518391 173185848673519 173185855519721 173185880508115 173185882961810 173185885916982 173186002270333 173186219634820 173186362308877 173186369113961 173186423441877 173186600461684 173186645035417 173186751738028 173186752858784 173186777366667 173186817672595 173186919928394 173187224801043 173187324237260 173187465122570 173187492505237 173187505175185 173187669287890 173187766849723 173187833691105 173187840465562 173187851637467 173187869522094 173187939266837 173188089508404 173189152273785 173191213687877 173192103894024 173192144446844 173192400490645 173192495592090 173192518157669 173192675569092 173192768143903 173192772960563 173192828531833 173192846250123 173192904320763 173193002036454 173193050420210 173193114668048 173193141495258 173193269181297 173193277228263 173193437471313 173193506151674 173193652289550 173193706117836 173193755643926 173193833733352 173194068902247 173194125054793 173194190579434 173194355190600 173194384790220 173194540943458 173194738479827 173194771333915 173194794664696 173194958238563 173194983410309 173195074960768 173195255263131 173195295173891 173195319916470 173195429689475 173195469319498 173195493740383 173195513658491 173195673080007 173195717105325 173195803163602 173195886420648 173195897773498 173196004216564 173196012610069 173196025884875 173196198676411 173196321311640 173196451551529 173196472130898 173196482293444 173196537124842 173196639513409 173196749775356 173196757056548 173196874288347 173196925627006 173197026892349 173197035594240 173197151792975 173197395136974 173197436342698 173197713121302 173199628677635 173199690524128 173200385953499 173200557841683 173200962678662 173201018726478 173201033371295 173201119622028 173201211053338 173201226331496 173201278544327 173201284257784 173201332989314 173201446649289 173201476746143 173201607592038 173201676096426 173201763806583 173201791182235 173201908712133 173202017418422 173202187221678 173202364577003 173202487656264 173202667388127 173202892805227 173203142734023 173203182177599 173203270847506 173203574360600 173203575076175 173203628905477 173203865820680 173204064896708 173204068922621 173204125521831 173204182780808 173204402590259 173204644893747 173204738156109 173204836165629 173204954595342 173205142087606 173205154086346 173205164654507 173205187805270 173205212133650 173205217602803 173205311406411 173205346148510 173205430348401 173205464729557 173205529170435 173205727725944 173208480383277 173208846564054 173208864151857 173208869696797 173209150676442 173209579663531 173209721829872 173209742285454 173209746060932 173209793791183 173209994464798 173210137490940 173210143226335 173210271259353 173210286280281 173210375637872 173210831700700 173210913151811 173211027797427 173211040838184 173211242057588 173211449526888 173211800591526 173211988309343 173212066939242 173212229391825 173212250168001 173212291849340 173212519652258 173212709880254 173212876334114 173212881133012 173212967567726 173213173450024 173213435538064 173213463352138 173213567838332 173213618297713 173213657586682 173213666838931 173213678212115 173213694133708 173213731853010 173213861718075 173213917563047 173214030655903 173214126088991 173214320517114 173214353075903 173214367437204 173214494614057 173214542528478 173217286332242 173217334231207 173217754431325 173217761498082 173217771619598 173217838108013 173217942598084 173217962596943 173217992660261 173218271256748 173218383407524 173218549357050 173218624543062 173218626834603 173219054941638 173219084224136 173219337374693 173219472136956 173219557413036 173219565554570 173219586946292 173219721252716 173219759563199 173219786393748 173220012347648 173220029623266 173220154528093 173220479749547 173220514743644 173220577356132 173220601705257 173220631488623 173220699027861 173220855124020 173221020430571 173221020500117 173221061551074 173221061612134 173221232438604 173221264074239 173221421706069 173221558929761 173221607479470 173221836372058 173222017281863 173222022627499 173222159703758 173222175331536 173222227211083 173222231725375 173222240165969 173222258274025 173222301357301 173222359320704 173222370837560 173222429253819 173222434165056 173222469662673 173222489279249 173222492091977 173222524328866 173222532640848 173222592162730 173222598098580 173222611875216 173222700746819 173222866279523 173222993377879 173223239213614 173223488846417 173223809102952 173225536407349 173225538943082 173225765708745 173226004847797 173226264572992 173226339166133 173226341238029 173226344054251 173226381750740 173226383313489 173226555406406 173226693936966 173226697556408 173226904179104 173226910920892 173226949746253 173227016925849 173227254416050 173227342368841 173227380105373 173227541516201 173227600606202 173227630446285 173227711826036 173227733351546 173227938262672 173227988851535 173228037174187 173228048330279 173228077164936 173228092445710 173228203079602 173228548874775 173228571633750 173228627342564 173228672209792 173228714521140 173228788176002 173228796280785 173229042667375 173229061440255 173229090431787 173229098561390 173229109681541 173229336544592 173229521732385 173229541568937 173229594690828 173229731636985 173229886710068 173229945518330 173230018868444 173230110514481 173230113366885 173230136006389 173230190395934 173230291880669 173230337132097 173230349402014 173230365634085 173230435462557 173230466541498 173230509815395 173230559992025 173230622878111 173230647870433 173230670808250 173230751765085 173230779337804 173230794586745 173230812502444 173230844094705 173230997978827 173231053435882 173231079383869 173231152857856 173231268563623 173231360605153 173231401058228 173231462054758 173231519240494 173231735585113 173231864644578 173231901262738 173232068593280 173232194775106 173232240730878 173234980755027 173234982689805 173235071068488 173235121746597 173235244571640 173235310104798 173235347035827 173235372477468 173235472400239 173235534621545 173235649981593 173235661979976 173235818981578 173235895717375 173236050243364 173236083711499 173236220664869 173236278216305 173236342585135 173236406145154 173236492294302 173236501459867 173236528379173 173236787559609 173237016362425 173237082329493 173237343132336 173237581777684 173237697362934 173237736768904 173237912922401 173237972323130 173238061238081 173238474892422 173238559547535 173238838648477 173238893240524 173238999936645 173239506641748 173239515151501 173240074733281 173240120923562 173240432973202 173240433028467 173240496670021 173241343818627 173243740097311 173243912590247 173244107999367 173244182688964 173244214611563 173244216582282 173244291961422 173244409312358 173244569896095 173244599762713 173244919062790 173245060566920 173245092421394 173245238724638 173245334794432 173245605755004 173245648030855 173247108108311"

# Write the header to the CSV file
# echo "order_id,currency,price_total" > "$output_file"

id_token_here="AMf-vBxfT0bM6pH_dI_9eF4DF2l44E4SrMOum_2i-XLfQPdWTHJIcnWQRLikLMwQsxtWuayzec95IS5VZBFEupO8ducZQARmt8IgG7RlVu7JugfT6C4SXZfYgxTvAVSU21y3PxXM8L5HlboqpiRtO2GIEnQnQ9tuDU5imvJimlXu2p1rGnSH2oJTFiQ0OlwWa5Rf_YabdKa4alxTc_pVnXVqYC0iW9PynuAFheDlnkxbBd47POVn0VYvVfTPg9x-1ifL7HcQa_3HB05oXpy1YBsheFPPkdkHeqVOetp6UhgGzFn3lOvxnrjuF78yXkCEcxykA0h8HavN4ePMoM-nzP4NMloPJtZV9foy4BOPD-LkO9HKIOEIcEjA_o8b7Vt1kLn_aKu_yX50DYZmNuiaXNWtnHXHlW5mSiiYkAHiFsEBylBGXTsJ0VCtcaBa5491YDflPwLWATfj"

vpn_connection_name_a="pfSense-UDP4-1194-rattan1-config"
vpn_connection_name_b="pfSense-UDP4-1194-rattan2-config"

check_vpn_connection() {
    if nmcli connection show --active | grep -q "$vpn_connection_name_b"; then
        echo "VPN ($vpn_connection_name_b) is active."
    elif nmcli connection show --active | grep -q "$vpn_connection_name_a"; then
        echo "VPN ($vpn_connection_name_a) is active. Disconnecting it."
        sudo nmcli connection down $vpn_connection_name_a
        echo "rattan22024" | sudo nmcli --ask connection up $vpn_connection_name_b
        if nmcli connection show --active | grep -q "$vpn_connection_name_b"; then
            echo "VPN ($vpn_connection_name_b) is now connected."
            return 0
        else
            echo "Failed to connect VPN ($vpn_connection_name_b). Exiting with Condition 2."
            exit 1
        fi
    else
        echo "VPN ($vpn_connection_name_b) is not active. Connecting to the VPN."
        echo "rattan22024" | sudo nmcli --ask connection up $vpn_connection_name_b
        echo "----------- Aboive Error Message-----------"
        if nmcli connection show --active | grep -q "$vpn_connection_name_b"; then
            echo "VPN ($vpn_connection_name_b) is now connected."
            return 0
        else
            echo "Failed to connect VPN ($vpn_connection_name_b). Exiting with condition 3."
            exit 1
        fi
    fi
}

# check_vpn_connection
# Loop through each order ID in the list
for order_id in $order_ids; do

    echo "http://localhost82.com/prioticket-refund/public/refundOrderFullQuantity/$order_id?refresh_token=$id_token_here&skip_third_party=0"
    
    response=$(curl -s "http://localhost82.com/prioticket-refund/public/refundOrderFullQuantity/$order_id?refresh_token=$id_token_here&skip_third_party=0")

    echo "$order_id" >> matchdata3.txt
    
    echo "$response" >> response3.json
    sleep 5
done

# jq -r '.response.data.order | "\(.order_reference): \(.order_status)"' response.json
