#!/bin/bash

# Define your order IDs here as a space-separated list
order_ids="172003550257765 172017192976958 172027055487050 172028451336175 172029658169521 172034896824109 172034983744424 172052482849614 172061653823117 172061696537152 172064838564212 172070776250753 172088603835050 172106232399330 172120623318177 172128498618013 172132020386513 172132795501964 172132916897160 172132962057563 172133017039468 172133144013530 172133218140531 172133378999828 172133962710209 172133997885129 172134155103247 172137038235518 172137384021915 172137441785062 172137674813426 172138731199699 172138992821099 172139690785658 172140747285444 172140771799738 172141219276854 172141770858913 172142422386453 172142486496771 172145679141581 172146116199881 172147110616884 172148438305959 172149691615628 172150381079330 172155523208425 172157288008784 172157770565574 172158479324327 172163870567518 172164406812198 172164670256284 172168224724595 172168312903661 172173009563317 172180828297611 172190778053349 172192307702477 172192865410361 172192865521219 172200312054225 172200313061507 172215090133633 172215949067608 172217064543463 172217403586471 172217706247065 172227918863984 172228992974244 172232839478170 172233851823502 172235260221632 172235267565489 172235363972841 172236686446081 172236705267471 172236767199535 172245330545362 172245830906381 172245903231683 172252718801907 172253271799282 172254043944000 172258972647550 172260126055815 172261345320662 172261366493317 172262768216838 172263319038934 172263630590148 172268641192978 172271277653973 172271278868757 172271284080636 172271454817498 172271529117396 172274711343469 172277801007999 172278504495276 172278538350626 172280129455862 172286658404505 172288269788861 172288290753387 172289014308773 172293128152456 172293825774569 172294051938961 172294213656357 172294260322657 172297652012714 172302594652891 172302691786204 172302862231580 172303614458654 172304299423969 172306311096490 172306339095985 172310151890290 172311259540465 172312675545273 172312691441708 172314153250591 172315604381069 172322500482549 172323341867671 172323539730625 172330857310105 172331277610788 172331474804833 172337513009547 172337699759405 172337725370844 172337811743384 172337889654170 172338218767247 172344986107004 172346344965338 172348648618828 172357600738398 172358156457434 172361503382033 172363768550033 172382902471027 172383455588661 172383726996110 172384665547116 172389828072950 172390243974777 172391521668367 172397455764394 172397456521620 172397845728742 172397897710018 172398024097962 172400686097789 172400935574463 172401168937536 172401216684064 172405362317686 172409393939064 172409590742882 172409691788620 172412590444182 172414643384474 172414855005489 172416539720861 172419162093200 172434615077001 172434906172507 172435168900065 172435343314480 172435378896041 172435622838862 172440101621979 172440163427025 172440886561009 172441156451977 172449468588481 172450677119353 172450920656812 172451752739225 172457832961729 172458900598979 172461139505564 172461253266337 172461507824811 172461628718154 172461929680987 172465540028338 172465694033258 172466155061320 172467613232268 172467831100376 172468834970762 172473434612730 172475212579325 172475491927397 172477008389341 172477566722938 172478208124301 172478432381717 172478439925821 172483079364017 172485731305828 172487391018010 172487396339865 172493574363262 172494580536598 172495544332188 172501658641711 172503301884240 172504251544237 172504447068941 172504488016834 172504856293485 172505119488811 172509466764395 172510099365923 172510927456323 172512171860358 172512330069043 172512456448725 172512807418169 172513640613367 172513683338962 172513684644864 172513903902595 172517099619126 172517759546245 172517880985324 172517954895867 172518032759099 172518058001308 172518122191573 172518504724919 172518541801651 172518789313138 172519227298863 172519388607231 172519400178434 172519720695723 172519971760284 172520369326151 172520545189550 172520588745086 172520914994002 172521213892373 172521439489663 172521786201002 172521903438247 172521922933516 172522130090089 172522347367387 172527351539289 172528244800986 172528572148857 172528720519304 172528812550027 172530128533547 172535104333383 172537190708539 172538845244674 172539044856915 172539085607272 172540360709371 172545944497845 172548208948046 172548225190212 172548318090434 172548971996282 172552846127232 172556025063470 172556465713579 172561250155313 172561309692299 172561574330980 172562815301537 172563997342546 172564668339326 172565195956350 172565425787184 172566261222991 172569506245429 172569523132929 172569541253738 172569659981805 172569835551878 172570522285196 172572305179191 172572713595843 172572975779221 172573044932436 172573103895251 172573822947954 172578088920428 172578135120942 172578467143544 172578757752868 172578857262027 172578975631745 172579312794649 172580533326110 172582359175193 172582444328597 172582854978778 172583106576119 172586946782458 172586971218178 172588497730264 172588554829721 172590128031950 172590867092258 172591117818455 172595311815174 172596181637497 172598157824175 172598190626088 172599314957182 172600238273046 172604289678864 172604696644845 172604733420850 172605160655461 172606370357991 172606642438458 172615125801039 172615548229514 172617109526539 172617141702115 172617573798629 172618246883070 172621349868267 172624302582231 172624592119650 172625895500783 172626241633880 172630265188636 172630537138776 172632307472406 172632436621152 172634605153058 172638388668942 172638542453939 172639014373295 172639051900926 172639405281397 172640602755676 172641341116761 172642443751428 172642445409119 172642899483163 172643015255085 172643015583783 172643187288954 172643284972001 172646528421014 172651389604488 172651389959260 172651495287791 172651893500524 172651979660717 172652193030487 172653100751278 172655313105976 172655323393083 172655519795497 172655695479079 172655750386096 172655809642825 172657598609166 172657701604181 172658820662912 172659863564275 172659909680452 172659918502046 172659952284116 172660009818264 172660053455669 172660298603449 172660383395961 172664609368173 172667744817292 172667749998987 172668352569092 172671825955805 172673554174267 172673571152589 172673701728395 172674047070100 172674223356335 172674682131613 172676283258819 172676849548864 172677562568689 172678201586108 172685314204716 172685355648982 172690306170194 172692148259713 172692308729867 172692382252695 172694511401554 172699170384500 172699475676390 172700389761392 172700684485122 172700842231939 172701040004231 172701445097351 172701474761648 172701906688495 172702899464776 172703150950520 172703170617229 172703472349655 172703696088524 172704783591455 172709051723954 172709113881639 172710266295504 172710790517663 172712000247876 172712008291831 172712290704055 172712605446660 172712714627594 172712730208928 172716604978373 172717166977289 172717623428723 172720022680946 172728698992614 172729530677370 172729609223634 172733301289259 172733598662505 172734227309368 172734736773932 172735409579372 172735411468101 172735470833986 172735747391475 172737245402733 172737447692876 172737757155089 172737799614418 172737813406444 172738009638372 172738370871692 172738413359605 172738870545202 172742998896849 172743580329792 172745075270916 172745144281895 172745326470858 172745805546042 172746521727513 172746583808312 172746586141539 172979834148990"

# Write the header to the CSV file
# echo "order_id,currency,price_total" > "$output_file"

id_token_here="AMf-vBwj06kSVOoklpV-X6Oojn4XRkOhYe4c9PK8O75QoUvucpbWazzohWKJfRVfgNZWyGMe0VR2N-KOlNLTXizQeNHcVhFanHSPiqyhLHafw6jgpZDnfHfVMLMotkAUEQ32tzCRsXOVjZTBR7loDtc0UWt03ZqcgIoDWFMulIvsX-dOvT1j7wBcClX8wglQP2L18tpJ6G-NSU7ehyXJ9_dGePutQVpHyFausrXvb-VgLITu_mfyUSQGfUx7PK_B0CsUTsuhRXB-4CtvGPbqMrqx_QoSIKyaATXawcH1NQWyjQOCU8gpLWFGfxPgtA4r7j0KZMzfuaA8N9qxrtPQherPDoSZ9A6E_htwg5S-i2dKKhpqECcST2vn6xUNWSDqTjWwhDP6pGQZABsPGGxDK7I9WWioHlE_4GWf-8ggLVN__eHZx9PSbRE7ay05SU0ggKfr4VR7faZP"

vpn_connection_name_a="pfSense-UDP4-1194-rattan1-config"
vpn_connection_name_b="pfSense-UDP4-1194-rattan2-config"

check_vpn_connection() {
    if nmcli connection show --active | grep -q "$vpn_connection_name_b"; then
        echo "VPN ($vpn_connection_name_b) is active."
    elif nmcli connection show --active | grep -q "$vpn_connection_name_a"; then
        echo "VPN ($vpn_connection_name_a) is active. Disconnecting it."
        sudo nmcli connection down $vpn_connection_name_a
        echo "rattan22024" | sudo nmcli --ask connection up $vpn_connection_name_b
        if nmcli connection show --active | grep -q "$vpn_connection_name_b"; then
            echo "VPN ($vpn_connection_name_b) is now connected."
            return 0
        else
            echo "Failed to connect VPN ($vpn_connection_name_b). Exiting with Condition 2."
            exit 1
        fi
    else
        echo "VPN ($vpn_connection_name_b) is not active. Connecting to the VPN."
        echo "rattan22024" | sudo nmcli --ask connection up $vpn_connection_name_b
        echo "----------- Aboive Error Message-----------"
        if nmcli connection show --active | grep -q "$vpn_connection_name_b"; then
            echo "VPN ($vpn_connection_name_b) is now connected."
            return 0
        else
            echo "Failed to connect VPN ($vpn_connection_name_b). Exiting with condition 3."
            exit 1
        fi
    fi
}

# check_vpn_connection
# Loop through each order ID in the list
for order_id in $order_ids; do

    echo "http://localhost82.com/prioticket-refund/public/refundOrderFullQuantity/$order_id?refresh_token=$id_token_here&skip_third_party=0"
    
    response=$(curl -s "http://localhost82.com/prioticket-refund/public/refundOrderFullQuantity/$order_id?refresh_token=$id_token_here&skip_third_party=0")
    
    echo "$order_id" >> matchdata.txt
    echo "$response" >> response.json
    sleep 2
done

# jq -r '.response.data.order | "\(.order_reference): \(.order_status)"' response.json

# jq -r '.response.data.order | "\(.order_reference): \(.order_status)"' response.json response1.json response2.json response3.json > test.json

# jq -r '.response.data.order | "\(.order_reference): \(.order_status)"' response.json